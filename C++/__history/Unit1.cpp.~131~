//---------------------------------------------------------------------------
#include <vcl.h>
#pragma hdrstop

#include "Unit1.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TIHM *IHM;
//---------------------------------------------------------------------------
__fastcall TIHM::TIHM(TComponent* Owner)
	: TForm(Owner)
{
	trameMarteau[0] = 0x00;
	trameMarteau[1] = 0x00;
	trameMarteau[2] = 0x00;
	trameMarteau[3] = 0x00;
	trameMarteau[4] = 0x00;
	trameMarteau[5] = 0x06;
	trameMarteau[6] = 0x00;

	trameMarteau[7] = 0x06;
	trameMarteau[8] = 0x00;
	trameMarteau[9] = 0x02;
	trameMarteau[10] = 0x00;
	trameMarteau[11] = 0x00;

	trameMarteau[12] = 0x01;
	trameMarteau[13] = 0x01;
}
//---------------------------------------------------------------------------
void __fastcall TIHM::BoutonConnexionClick(TObject *Sender)
{
	if(cloche.Connexion())
	{
		Label1->Color = clGreen;
		BoutonDeconnexion->Enabled = true;
		BoutonConnexion->Enabled = false;

		BoutonCloche1->Enabled = true;
		BoutonCloche2->Enabled = true;
		BoutonCloche3->Enabled = true;
		BoutonCloche4->Enabled = true;
	}
}
//---------------------------------------------------------------------------
void __fastcall TIHM::BoutonDeconnexionClick(TObject *Sender)
{
	if(cloche.Deconnexion())
	{
		Label1->Color = clRed;
		BoutonConnexion->Enabled = true;
		BoutonDeconnexion->Enabled = false;

		BoutonCloche1->Enabled = false;
		BoutonCloche2->Enabled = false;
		BoutonCloche3->Enabled = false;
		BoutonCloche4->Enabled = false;
    }
}
//---------------------------------------------------------------------------


void __fastcall TIHM::BoutonCloche1Click(TObject *Sender)
{
	cloche.Cloche1(trame);
	Sleep(250);
	cloche.EnvoiTrame(trameMarteau, 14);
}
//---------------------------------------------------------------------------

void __fastcall TIHM::BoutonCloche2Click(TObject *Sender)
{
	cloche.Cloche2(trame);
	Sleep(250);
	cloche.EnvoiTrame(trameMarteau, 14);
}
//---------------------------------------------------------------------------

void __fastcall TIHM::BoutonCloche3Click(TObject *Sender)
{
	cloche.Cloche3(trame);
	Sleep(250);
	cloche.EnvoiTrame(trameMarteau, 14);
}
//---------------------------------------------------------------------------

void __fastcall TIHM::BoutonCloche4Click(TObject *Sender)
{
	cloche.Cloche4(trame);
	Sleep(250);
	cloche.EnvoiTrame(trameMarteau, 14);
}
//---------------------------------------------------------------------------

void __fastcall TIHM::FormKeyDown(TObject *Sender, WORD &Key, TShiftState Shift)
{
	if(Key == VK_F1)
		BoutonCloche1Click(TIHM);
	if(Key == 0x30)
		BoutonCloche1Click(TIHM);
	if(Key == 0x30)
		BoutonCloche1Click(TIHM);
	if(Key == 0x30)
		BoutonCloche1Click(TIHM);
}
//---------------------------------------------------------------------------

